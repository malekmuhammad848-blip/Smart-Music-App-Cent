<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CENT MUSIC | Admin Panel</title>
    <style>
        :root { --gold: #D4AF37; --bg: #0f0f0f; --card: #1e1e1e; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        h1 { color: var(--gold); text-align: center; letter-spacing: 3px; font-weight: bold; }
        
        .search-box { display: flex; gap: 10px; margin-bottom: 30px; }
        input { flex: 1; padding: 15px; border-radius: 8px; border: 1px solid #333; background: #222; color: white; outline: none; }
        input:focus { border-color: var(--gold); }
        button { padding: 10px 25px; background: var(--gold); border: none; border-radius: 8px; color: black; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { background: #b8962d; transform: scale(1.05); }

        .results-grid { display: grid; gap: 15px; }
        .song-card { background: var(--card); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; border: 1px solid #2a2a2a; }
        .song-card img { width: 80px; height: 80px; border-radius: 8px; object-fit: cover; }
        .song-info { flex: 1; }
        .song-title { font-size: 16px; font-weight: bold; margin-bottom: 5px; color: #fff; }
        .song-artist { font-size: 13px; color: #aaa; }
        .add-btn { background: #28a745; color: white; padding: 8px 15px; font-size: 12px; }
        .add-btn:hover { background: #218838; }

        .loader { display: none; margin: 20px auto; border: 4px solid #f3f3f3; border-top: 4px solid var(--gold); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="container">
    <h1>CENT ADMIN</h1>
    
    <div class="search-box">
        <input type="text" id="searchInput" placeholder="Search for songs or artists on YouTube...">
        <button onclick="searchYouTube()">SEARCH</button>
    </div>

    <div id="loader" class="loader"></div>
    <div id="results" class="results-grid"></div>
</div>

<script>
    async function searchYouTube() {
        const query = document.getElementById('searchInput').value;
        if (!query) return;

        const resultsDiv = document.getElementById('results');
        const loader = document.getElementById('loader');

        resultsDiv.innerHTML = '';
        loader.style.display = 'block';

        try {
            const response = await fetch(`/api/search?query=${encodeURIComponent(query)}`);
            const songs = await response.json();
            
            loader.style.display = 'none';
            
            songs.forEach(song => {
                const card = document.createElement('div');
                card.className = 'song-card';
                card.innerHTML = `
                    <img src="${song.cover}" alt="cover">
                    <div class="song-info">
                        <div class="song-title">${song.title}</div>
                        <div class="song-artist">${song.artist}</div>
                    </div>
                    <button class="add-btn" onclick="addToDatabase('${song.title.replace(/'/g, "")}', '${song.artist.replace(/'/g, "")}', '${song.youtubeId}', '${song.cover}')">ADD TO APP</button>
                `;
                resultsDiv.appendChild(card);
            });
        } catch (error) {
            loader.style.display = 'none';
            alert("Error searching songs. Check server connection.");
        }
    }

    async function addToDatabase(title, artist, youtubeId, cover) {
        try {
            const response = await fetch('/api/songs/add', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ title, artist, youtubeId, cover })
            });
            const data = await response.json();
            alert(data.message || "Song added to your app!");
        } catch (error) {
            alert("Failed to add song.");
        }
    }
</script>

</body>
</html>
